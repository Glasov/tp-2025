# Лаба 7 - Архитектура, слои и DDD-lite

На лекции мы разобрали слоистую архитектуру, DIP и основы DDD-lite.
В этой лабораторной работе нужно реализовать небольшую систему оплаты заказа с разделением по слоям и доменной моделью.

## Что нужно сделать

Реализовать проект со следующими слоями:

* Domain - доменная модель и бизнес-правила
* Application - use-case
* Infrastructure - реализации интерфейсов
* Tests - тесты use-case без базы данных

Сдать ссылку на репозиторий.

## Содержание

### 1. Domain

Реализовать доменную модель заказа.

Требования к модели:

* `Order` - сущность
* `OrderLine` - часть агрегата
* `Money` - value object
* `OrderStatus` - перечисление или набор констант

Инварианты:

* нельзя оплатить пустой заказ
* нельзя оплатить заказ повторно
* после оплаты нельзя менять строки заказа
* итоговая сумма равна сумме строк

### 2. Application

Реализовать use-case `PayOrderUseCase`, который:

* загружает заказ через `OrderRepository`
* выполняет доменную операцию оплаты
* вызывает платёж через `PaymentGateway`
* сохраняет заказ
* возвращает результат оплаты

### 3. Интерфейсы

Определить интерфейсы:

* `OrderRepository`

  * `get_by_id(order_id)`
  * `save(order)`

* `PaymentGateway`

  * `charge(order_id, money)`

### 4. Infrastructure

Реализовать как минимум:

* `InMemoryOrderRepository`
* `FakePaymentGateway`

Реальная БД не требуется.

### 5. Тесты

Добавить тесты, проверяющие:

* успешную оплату корректного заказа
* ошибку при оплате пустого заказа
* ошибку при повторной оплате
* невозможность изменения заказа после оплаты
* корректный расчёт итоговой суммы
